{% extends "cmumc/base2.html" %}

    {% block content %}

            {% comment %}

            {% endcomment %}

            {% if message %}
            <p>{{ message }}</p>
            {% endif %}

            <div class="col-mid-9 col75 mytask_col">
              <div class="panel panel-default">
                	<h3 class="content_title panel-heading">My Task</h3>
                  <div class="">
                    <table id="tasks-table" class="table tbale-bordered table--highlighted flush--bottom">
                      <thead>
                        <tr class="table-title">
                          <th class="text--center"></th>
                          <th>Title</th>
                          <th>Poster</th>
                          <th>Category</th>
                          <th>Price</th>
                          <th>Status</th>
                          </tr>
                        </tr>
                      </thead>

                      {% for post in posts %}

                      <tbody class="align--top">
                        
                          <tr data-toggle="collapse" data-target="#post{{ post.post_id }}" role="button" aria-expanded="false" aria-controls="post{{ post.post_id }}">
                            <td class="text--center">
                              {% if post.status != 'NC' %}
                              <span class="glyphicon glyphicon-triangle-bottom"></span>
                              {% endif %}
                            </td>
                            <td>{{ post.title }}</td>
                            <td>{{ post.created_user }}</td>
                            <td>{{ post.category }}</td>
                            <td>${{ post.price }}</td>
                            <td>{{ post.status }}</td>
                          </tr>

                        {% if post.status == 'A' %}
                          <tr class="hard" >
                            <td colspan="8" class="colspan-nopadding">
                              <div id="post{{ post.post_id }}" class="collapse">
                                <div class="task-expand">
                                  <div class="col60">
                                    <p>Description: {{post.description}}</p>
                                  </div>
                                  {% if user == post.created_user %}
                                  <div class="col40 mytask_btn_container">
                                  <span><a href="{% url 'editPost' post.post_id %}" class="btn btn-small"><span class="gradient" id="edit_post_btn">Edit</span></a></span>
                                  <span><a href="{% url 'deletePost' post.post_id %}" class="btn btn-small"><span class="gradient" id="delete_post_btn">Delete</span></a></span>
                                  </div>
                                  {% endif %}
                                </div>
                              </div>
                            </td>
                          </tr>

                        {% elif post.status == 'NC' and user == post.created_user %}
                          <tr class="hard" >
                            <td colspan="8" class="colspan-nopadding">
                            <div id="post{{ post.post_id }}" class="collapse">
                              <div class="task-expand">
                                <form method="post" action="{% url 'accept' post.post_id %}">
                                  {% for requester in post.accept_list.all %}
                                  <div class="col60">
                                      <div notes="http://stackoverflow.com/questions/5924988/radio-buttons-in-django-forms"></div>
                                      <div class="accept_list_options form-check">
                                        <input type="radio" name="requester" value="{{ requester.username }}" class="form-check-input" />
                                        <label>Requester: {{ requester.username }}</label>
                                      </div>
                                  </div>
                                  {% endfor %}
                                  <div class="col40">
                                   {% comment %}
                                   <input type="submit" id="edit_post_btn" class="btn btn-md btn-primary btn-block" value="Confirm">
                                   {% endcomment %}
                                    <div class="right-btn-container">
                                      <span class="btn">
                                        <input type="submit" id="edit_post_btn" class="gradient" value="Confirm">
                                      </span>
                                    </div>
                                  </div>
                                {% csrf_token %}
                                </form>
                              </div>
                            </div>
                            </td>
                          </tr>

                        {% elif post.status == 'I' %}
                          <tr class="hard" >
                            <td colspan="8" class="colspan-nopadding">
                              <div id="post{{ post.post_id }}" class="collapse">
                                <div class="task-expand">
                                  <div class="col60">
                                    <p>Description: {{post.description}}</p>
                                  </div>
                                  <div class="col40 right-btn-container">
                                   <span><a href="{% url 'complete' post.post_id %}" class="btn btn-small"><span class="gradient" id="edit_post_btn">Complete</span></a></span>
                                  </div>
                                </div>
                              </div>
                            </td>
                          </tr>

                          {% elif post.status == 'C' %}
                          <tr class="hard" >
                            <td colspan="8" class="colspan-nopadding">
                              <div id="post{{ post.post_id }}" class="collapse">
                                <div class="task-expand">
                                  <div class="col60">
                                    <p>Description: {{post.description}}</p>
                                  </div>
                                  <div class="col40 right-btn-container">
                                   <span><a href="{# % url 'rate' post.post_id % #}" class="btn btn-small"><span class="gradient" id="edit_post_btn">Rate</span></a></span>
                                  </div>
                                </div>
                              </div>
                            </td>
                          </tr>

                        {% endif %}


                      </tbody>

                      {% endfor %}

                    </table>
                  </div>
              </div>
            </div>

        </div>
    </div>
    {% endblock %}